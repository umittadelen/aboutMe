<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>umittadelen</title>

        <link rel="icon" href="./favicon.gif" type="image/gif">
        <script src="./builder.js"></script>

        <link id="stylesheet" rel="stylesheet" href="./mainA.css">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
    </head>
    <body>
        <h1 id="center"><span onclick="switchText()">ABOUT ME:</span></h1>
        <p class="aboutText" id="aboutText">
            he<b>/</b>him<br>
            <b>16</b> years old<br>
            gamer <b>/</b> programmer <b>/</b> 3D designer<br>
            Oslo<b>/</b>Norway
        </p>
        <p class="aboutText">
            <b><span onclick="switchCSS()">(this website is work-in-progress)</span></b>
        </p>
        <p class="aboutText"><span id="visit-count"></span></p>
        
        <myBody>
        </myBody>

        <script>
            function switchCSS() {
                const currentStylesheet = document.getElementById("stylesheet");
                    // Check if it's mainA.css or mainB.css and toggle between them
                    if (currentStylesheet.getAttribute("href") === "./mainA.css") {
                        currentStylesheet.setAttribute("href", "./mainB.css");
                    } else {
                        currentStylesheet.setAttribute("href", "./mainA.css");
                    }
            }

            let currentTextIndex = 0;

            const texts = [
                `he<b>/</b>him<br>
                <b>16</b> years old<br>
                gamer <b>/</b> programmer <b>/</b> 3D designer<br>
                Oslo<b>/</b>Norway`,
                
                `currently not working<br>
                content creator<br>
                arnigts <b>/</b> HSR <b>/</b> BA <b>/</b> PJSK<br>
                Python <b>/</b> HTML <b>/</b> CSS <b>/</b> JS`,
            ];

            function switchText() {
                const aboutText = document.getElementById("aboutText");
                currentTextIndex = (currentTextIndex + 1) % texts.length;
                aboutText.innerHTML = texts[currentTextIndex];
            }

            const REPO = "umittadelen/aboutMe"; // Replace with your repo
            const GITHUB_API = `https://api.github.com/repos/${REPO}/dispatches`;
            const VISIT_FETCH_URL = `https://raw.githubusercontent.com/${REPO}/main/visits.json`;
            const RATE_LIMIT_TIME = 5 * 60 * 1000; // 5 minutes in milliseconds

            // Fetch the current visit count
            fetch(VISIT_FETCH_URL)
                .then((response) => response.json())
                .then((data) => {
                    document.getElementById("visit-count").innerText = data.visits;
                });

            // Function to trigger GitHub Action
            function incrementVisitCount() {
                const lastVisitTime = localStorage.getItem("lastVisitTime");
                const now = new Date().getTime();

                if (lastVisitTime && now - lastVisitTime < RATE_LIMIT_TIME) {
                    console.log("You are visiting too frequently. Try again later.");
                    return; // Block the request
                }

                // Store the current time as the last visit time
                localStorage.setItem("lastVisitTime", now);

                // Trigger GitHub Action
                fetch(GITHUB_API, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        event_type: "increment_visits",
                    }),
                }).catch(console.error);
            }

            // Trigger the visit increment when the page is loaded
            incrementVisitCount();
        </script>
    </body>
</html>
